<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook50-profile.xsl"
                 type="text/xml" 
                 title="Profiling step"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="bp.lifecycle">


    <title>Advanced Patch Lifecycle Management</title>

    <sect1 xml:id="bp.chap.adv.life.mgr.covered">
        <title>Whats Covered Here?</title>

        <para>This chapter describes how to setup and configure a &susemgr; testing implementation
            to enable companies in the delivery of these often requested features: <itemizedlist>
                <listitem>
                    <para>Automatic creation and archive of patch sets by quarter (or any other time
                        period)</para>
                </listitem>
                <listitem>
                    <para>Consistent method of patch promotion and delivery through numerous
                        landscapes and environments</para>
                </listitem>
                <listitem>
                    <para>Exception process for handling patches that need to be excluded from a
                        patch cycle</para>
                </listitem>
                <listitem>
                    <para>Environment creation with historical patch sets</para>
                </listitem>
                <listitem>
                    <para>Minimal need for host channel subscription manipulation from
                        cradle-to-grave</para>
                </listitem>
                <listitem>
                    <para>Support for service-pack migration using custom child channels</para>
                </listitem>
                <listitem>
                    <para>Provides a foundation for using multiple organizations to maintain
                        systems.</para>
                </listitem>
            </itemizedlist>
        </para>
    </sect1>

    <sect1>
        <title>Assumptions</title>
        <para>This guide covers &susemgr; &productnumber3;. A fresh installation is not required but
            some assumptions are made. You have a working &susemgr; environment, with a few
            registered clients, and a decent knowledge of &susemgr; terms and capabilities. If you
            are unfamiliar with these terms or do not have a current working setup, see the: <link
                linkend="quickstart.chapt.overview.requirements">Getting Started Guide</link></para>
        <note>
            <title>spacecmd and XMLRPC Examples</title>
            <para>Using advanced features such as <systemitem>spacecmd</systemitem> or
                    <systemitem>XMLRPC</systemitem> API will be explained in some detail, but will
                not be exhaustive. Code examples will be included at the end of this chapter which
                may be modified or used as-is. These come with no <emphasis>WARRANTY</emphasis> and
                should not be expected to run with every implementation. <emphasis>Always</emphasis>
                test before running any examples in production.</para>
        </note>
    </sect1>

    <sect1 xml:id="bp.chap.adv.patch.life.mgr.overview">
        <title>Patch Lifecycle Management Overview</title>
        <para>Keeping systems patched and secure remains one of the greatest ongoing challenges
            which you will face as an administrator. Both proprietary and open-source companies are
            constantly working to provide updates which fix flaws discovered within their software
            products.</para>

        <para>Adding to these pressures are requirements imposed by compliance initiatives such as: <itemizedlist>
                <listitem>
                    <para>PCI-DSS (Payment Card Industry Data Security Standard)</para>
                </listitem>
                <listitem>
                    <para>SOX (Sarbanes-Oxley)</para>
                </listitem>
                <listitem>
                    <para>HIPAA (Health Insurance Portability and Accountability Act)</para>
                </listitem>
                <listitem>
                    <para>FIPS 140 (Federal Information Processing Standard)</para>
                </listitem>
            </itemizedlist>Included in most of these standards are rules which dictate frequency and
            time frames required for patching and often these schedules are modified due to the
            severity level of a specific patch.</para>

        <para>Businesses depend upon a changing landscape of applications covering a wide range of
            compute infrastructure. These may include physical and virtual hosts and have
            complicated application stacks. </para>
        <para>These applications may require the following: <itemizedlist>
                <listitem>
                    <para>A specific kernel version</para>
                </listitem>
                <listitem>
                    <para>Strict uptime requirements</para>
                </listitem>
                <listitem>
                    <para>Specific run-time environments, (like Java)</para>
                </listitem>
                <listitem>
                    <para>Specific Linux OS release</para>
                </listitem>
                <listitem>
                    <para>Specific configuration requirements</para>
                </listitem>
                <listitem>
                    <para>Hardening and platform requirements</para>
                </listitem>
                <listitem>
                    <para>Specific software versions</para>
                </listitem>
            </itemizedlist>
        </para>
        <para>Additionally, many companies have created duplicate host environments such as: <itemizedlist>
                <listitem>
                    <para>Production (PROD)</para>
                </listitem>
                <listitem>
                    <para>Development (DEV)</para>
                </listitem>
                <listitem>
                    <para>Quality Assurance (QA)</para>
                </listitem>
                <listitem>
                    <para>User-acceptance/Testing (UAT)</para>
                </listitem>
            </itemizedlist> These landscapes mirror production environments and allow for testing or
            validation of applied changes to a system or set of systems. This means that you are
            required to manage, patch and report on at least one more complete set of hosts. </para>

        <sect2>
            <title>Important Terminology</title>
            <para>The following paragraphs provide an explanation of important terms used throughout
                this chapter.</para>
            <formalpara>
                <title>Landscape</title>
                <para>Describes one of several groups of Linux hosts. This is commonly used with
                    enterprise software deployments as a way to define the role/quality of a host.
                    Examples include, production (PROD), development (DEV), quality-assurance (QA),
                    user-acceptance/testing (UAT), etc.</para>
            </formalpara>
            <formalpara>
                <title>Environment</title>
                <para>Defined as a physical separation of Linux hosts, like Corporate (CORP), or
                    Store (STORE), or NPE (Non-production Environment).</para>
            </formalpara>
            <formalpara>
                <title>Organizations</title>
                <para>Defined as a separate management environment placed under the default
                    organization which is created during initial installation of a SUSE Manager
                    Server. Organizations in SUSE Manager will typically have separate credentials
                    required to administer them via the WebUI and any Linux hosts managed by SUSE
                    Manager will be registered to a single organization and only visible to this
                    organization.</para>
            </formalpara>
        </sect2>
    </sect1>

    <sect1>
        <title>Example Scenario</title>
        <formalpara>
            <title>The Chameleon Corporation</title>
            <para>The world’s largest reptile and amphibian pet store whose headquarters are located
                in Yemen. This corporation has more than 1500 stores operating under the names
                    <emphasis>LizardsRUs</emphasis>, <emphasis>UnVeiledInc</emphasis> and
                    <emphasis>Chameleo-rama</emphasis> in five different countries. Due to
                compliance constraints, their patch lifecycle (both timing and delivery) is based on
                their corporate security policies, host environments, landscapes, and future
                management needs. The Chameleon Corporation must maintain the following requirements
                for managing patch and security updates to their Linux hosts:<itemizedlist>
                    <title>Requirement Summary</title>
                    <listitem>
                        <para>The published Security Policy states: "All Linux systems need to be
                            up-to-date with the latest available updates, bug-fixes and enhancements
                            on a quarterly basis."</para>
                        <para>Quarters are defined as: <itemizedlist>
                                <listitem>
                                    <para>Q1: January 1st through March 31st</para>
                                </listitem>
                                <listitem>
                                    <para>Q2: April 1st through June 30th</para>
                                </listitem>
                                <listitem>
                                    <para>Q3: July 1st through September 30th</para>
                                </listitem>
                                <listitem>
                                    <para>Q4: October 1st through December 31st</para>
                                </listitem>
                            </itemizedlist></para>
                    </listitem>

                    <listitem>
                        <para>The published Security Policy also states the need to patch all Linux
                            systems with “critical” security updates (CVSS score of 7 or greater)
                            within 1 month of release of the patch. This introduces a second
                            schedule that may overlap any existing patch roll-out.</para>
                    </listitem>
                    <listitem>
                        <para>The company has 3 different host environments,
                                <emphasis>Corporate</emphasis>, <emphasis>Store</emphasis> and
                                <emphasis>NPE</emphasis>.These are partitioned using SUSE Manager
                            Organizations. Each SUSE Manager Organization has visibility into the
                            default SUSE Manager Organization’s software channels due to trusts, yet
                            the managed hosts are naturally grouped and managed by their
                            environment.</para>
                    </listitem>
                    <listitem>
                        <para>There are at least 3 landscapes in each environment,
                                <emphasis>PROD</emphasis>,<emphasis>DEV</emphasis>, and
                                <emphasis>UAT</emphasis>.</para>
                    </listitem>
                    <listitem>
                        <para>A “patch exceptions" process exists, as there is often a need to
                            account for the removal of patches (e.g. kernel updates) from a
                            roll-out. Some hosts may have hardware drivers or third party software
                            which depend upon specific kernel versions. This exception process would
                            be handled on a case-by-case basis.</para>
                    </listitem>
                </itemizedlist>
            </para>
        </formalpara>
    </sect1>
    <!-- The following section needs to be revised. It is wordy, and large amount of content difficult to read
        through. Goals: Shorten and reorganize. -->
    <sect1>
        <title>Implementation</title>
        <para>To review, you need to configure SUSE Manager, creating a set of procedures, processes
            and/or tools (scripts) to help with your patch lifecycle management. This includes the
            creation (and optimally an “automatic” creation) of patch archive channels from the SUSE
            provided “updates” channels for the versions of SLES you use. These patch archives will
            be the sources for your patch promotions, but can also be a source to setup testing
            environments based on a patch set rolled out in the past. This could be used to
            troubleshoot an error condition for example, by creating a lab full of hosts patched up
            to any previous patch set. You may also demonstrate and visualize a clear view of
            compliance defined by a time-stamped set of patches.</para>

        <para>You also will create a set of software channels which will be updated when you need to
            roll them out. Each landscape should receive these updates only from a previously
            “validated” landscape. This means a landscape patch set will first get put into DEV,
            tested, then move to QA, undergo tests and finally be moved into the PROD landscape.
            This process will begin anew each quarter, and you will handle exceptions if/when they
            occur.</para>

        <para>Every exception will be tracked by another established process with the constant goal
            of re-mediating any exception and making sure the patch is reintroduced as quickly as
            possible in order to ensure a clear view of compliance.</para>

        <para>Other interruptions to a quarterly roll-out might be the release of a “critical”
            security patch that needs to be deployed more rapidly than once-a-quarter. In order to
            handle this extra schedule, you will need to create an addition channel for any critical
            patches to track them and their roll-out. Critical patches should be considered any CVE
            that has a CVSS score of 7.1 or greater, or otherwise be mandated by your corporate
            security organization.</para>

        <para>For this implementation you will use two different SLES versions, SLES 11 SP3 and SLES
            12. You will plan to use SUSE Manager to assist with your service pack migrations, so
            setting up to account for SLES 11 SP4 initially would be ideal. We also maintain both
            32-bit and 64-bit Intel/AMD architecture versions of SLES 11 SP3 so we will need to
            account for both of them.</para>

        <para>There are 2 different environments we need to manage, Corporate (CORP) and Store
            (STORE). We have created separate SUSE Manager Organizations to allow our systems
            administrators an exclusive view of the hosts they are responsible for. Each SUSE
            Manager Organization has the 3 landscapes (DEV, QA and PROD) that they use for patch
            testing/promotion.</para>

        <para>Activation keys and bootstraps should be created for each SUSE Manager Organization
            (each environment) and each landscape so that hosts can be registered into their
            appropriate, and most likely, permanent role. For example, a bootstrap script will
            register a SLES 11 SP3 (64bit) DEV host into the correct organization and will add the
            appropriate base and child channels that should never have to be manipulated
            again.</para>

        <para>Automation is preferred. As mentioned, the use of scripts or scheduled jobs would
            greatly enhance this solution and make it easier for support staff.</para>

        <sect2>
            <title>Base Channels and Architecture</title>

            <para>This represents a high-level outline of the architecture and channels:</para>

            <note>
                <title>Tip: Base Channel Naming</title>
                <para>Any Base channel listed can also be a clone tree of the SUSE vendor channels
                    therefore should include a prefix in the name. This can aid the handling of
                    service pack migrations described during channel creation. See:
                    <!-- <link
                        linkend="">Channel Creation</link> -->.</para>
            </note>

            <para>
                <itemizedlist>
                    <listitem>
                        <para>SUSE Manager Organization <itemizedlist>
                                <listitem>
                                    <para>Default(Main) - 1 <itemizedlist>
                                            <listitem>
                                                <para>32 Bit Archive Channels (Public) <itemizedlist>
                                                  <listitem>
                                                  <para>Q2 - 06-30-2016 - SLES 11 SP3 Updates for
                                                  i586</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Q3 - 09-30-2016 - SLES 11 SP3 Updates for
                                                  I586</para>
                                                  </listitem>
                                                  </itemizedlist></para>
                                            </listitem>
                                            <listitem>
                                                <para>64 Bit Archive Channels(Public) <itemizedlist>
                                                  <listitem>
                                                  <para>Q2 - 06-30-2016 - SLES 11 SP3 Updates for
                                                  x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Q3 - 09-30-2016 - SLES 11 SP3 Updates for
                                                  x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Q2 - 06-30-2016 - SLES 12 Updates for
                                                  x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Q3 - 09-30-2016 - SLES 12 Updates for
                                                  x86_64</para>
                                                  </listitem>
                                                  </itemizedlist></para>
                                            </listitem>
                                            <listitem>
                                                <para>Clone Sets or Child Channels within SUSE Base
                                                  Channels:</para>
                                            </listitem>
                                            <listitem>
                                                <para>Base : SLES 11 SP3 Pool for i586 <itemizedlist>
                                                  <listitem>
                                                  <para>DEV - Current Patch Set - SLES 11 SP3
                                                  Updates for i586</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>QA - Current Patch Set - SLES 11 SP3 Updates
                                                  for i586</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>PROD - Current Patch Set - SLES 11 SP3
                                                  Updates for i586</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Patch Exceptions (DO NOT SUBSCRIBE) - SLES
                                                  11 SP3 i586</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Security ASAP Exceptions - SLES 11 SP3
                                                  i586</para>
                                                  </listitem>

                                                  </itemizedlist></para>
                                            </listitem>
                                            <listitem>
                                                <para>Base : SLES 11 SP3 Pool for x86_64 <itemizedlist>
                                                  <listitem>
                                                  <para>DEV - Current Patch Set - SLES 11 SP3
                                                  Updates for x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>QA - Current Patch Set - SLES 11 SP3 Updates
                                                  for x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>PROD - Current Patch Set - SLES 12 Updates
                                                  for x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Patch Exceptions (DO NOT SUBSCRIBE) - SLES
                                                  12 x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Security ASAP Exceptions - SLES 12
                                                  x86_64</para>
                                                  </listitem>
                                                  </itemizedlist></para>
                                            </listitem>
                                            <listitem>
                                                <para>Base : SLES 12 Pool for x86_64<itemizedlist>
                                                  <listitem>
                                                  <para>DEV - Current Patch Set - SLES 12 Updates
                                                  for x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>QA - Current Patch Set - SLES 12 Updates for
                                                  x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>PROD - Current Patch Set - SLES 12 Updates
                                                  for x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Patch Exceptions (DO NOT SUBSCRIBE) - SLES
                                                  12 x86_64</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Security ASAP Exceptions - SLES 12
                                                  x86_64</para>
                                                  </listitem>
                                                  </itemizedlist></para>
                                            </listitem>
                                            <listitem>
                                                <para>Patch Exceptions Channels (as above)<itemizedlist>
                                                  <listitem>
                                                  <para>Per Base Channel - 1 channel for each
                                                  “Updates” channel:<itemizedlist>
                                                  <listitem>
                                                  <para>Examples:<itemizedlist>
                                                  <listitem>
                                                  <para>Patch Exceptions (DO NOT SUBSCRIBE) - SLES
                                                  11 SP3 i586</para>
                                                  </listitem>
                                                  <listitem>
                                                  <para>Security ASAP Exceptions - SLES 11 SP3
                                                  i586</para>
                                                  </listitem>
                                                  </itemizedlist></para>
                                                  </listitem>
                                                  </itemizedlist></para>
                                                  </listitem>
                                                  </itemizedlist></para>
                                            </listitem>
                                        </itemizedlist>
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>Corporate (CORP) - 2<itemizedlist>
                                            <listitem>
                                                <para>Any public channel will be visible here</para>
                                            </listitem>
                                            <listitem>
                                                <para>Private channels can be shared
                                                  per-organization</para>
                                            </listitem>
                                        </itemizedlist></para>
                                </listitem>
                                <listitem>
                                    <para>Store (STORE) - 3<itemizedlist>
                                            <listitem>
                                                <para>Any public channel will be visible here</para>
                                            </listitem>
                                            <listitem>
                                                <para>Private channels can be shared
                                                  per-organization</para>
                                            </listitem>
                                        </itemizedlist></para>
                                </listitem>
                            </itemizedlist>
                        </para>
                    </listitem>
                </itemizedlist>
            </para>
        </sect2>
        <sect2>
            <title>Automation and Process Design</title>
            <para/>
        </sect2>
        <sect2>
            <title>Patch Promotion Cycle</title>
            <para/>
        </sect2>
        <sect2>
            <title>Exception and Escalation Channels</title>
            <para/>
        </sect2>
        <sect2>
            <title>Components</title>
            <para/>
        </sect2>
        <sect2>
            <title>Channels</title>
            <para/>
        </sect2>
        <sect2>
            <title>Activation Keys and Bootstrapping</title>
            <para/>
        </sect2>
        <sect2>
            <title>Scripts</title>
            <para/>
        </sect2>
        <sect2>
            <title>Crontab Entries and Automation</title>
            <para/>
        </sect2>


    </sect1>

    <sect1>
        <title>Use Cases and Workflows</title>
        <para/>
    </sect1>



</chapter>
