<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook50-profile.xsl"
                 type="text/xml" 
                 title="Profiling step"?>
<!DOCTYPE chapter[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0"
    xml:id="advanced.topics.adding.vmware.esxi.host">


    <title>Inventory and Manage vCenter and vSphere ESXi Hosts Using Virtual Host Manager</title>

    <sect1>
        <title>Introduction</title>
        <para>With the release of SUSE Manager 3, foreign virtual hosts (e.g. vCenter and vSphere
            ESXi) may be inventoried using the <filename>Virtual Host Manager</filename>. From the
            vSphere Client you can define roles and permissions for vCenter /vSphere ESXi users
            allowing vSphere objects and resources to be imported and inventoried by SUSE Manager.
            Objects and resources are then displayed as foreign hosts on the SUSE Manager <menuchoice>
                <guimenu>Systems</guimenu>
                <guimenu>Virtual Systems</guimenu>
            </menuchoice> page.</para>
        <para>The following sections will guide you through: </para>
        <itemizedlist>

            <listitem>
                <para>Adding new users to vSphere ESXi using the vSphere Client</para>
            </listitem>
            <listitem>
                <para>Adding new users to vCenter via command line</para>
            </listitem>
            <listitem>
                <para>Setting permissions and roles in vCenter and vSphere ESXi</para>
            </listitem>
            <listitem>
                <para>Adding vCenter and vSphere ESXi hosts to SUSE Manager</para>
            </listitem>
            <listitem>
                <para>Bootstrapping supported ESXi hosts, (e.g. SLES and RES) for management via
                    Salt</para>
            </listitem>
        </itemizedlist>
    </sect1>
    <sect1>
        <title>Requirements</title>
        <para/>
        <informaltable>
            <tgroup cols="2">
                <colspec colname="c1" colwidth="1*"/>
                <colspec colname="c2" colwidth="1*"/>
                <thead>
                    <row>
                        <entry><para>Ports / Permissions</para></entry>
                        <entry><para>Description</para></entry>
                    </row>
                </thead>
                <tbody>
                    <row>
                        <entry><para>443</para></entry>
                        <entry><para>Default port that SUSE Manager uses to access the ESXi API for obtaining infrastructure
                                data</para></entry>
                    </row>
                    <row>
                        <entry><para>read-only</para></entry>
                        <entry><para>All vCenter/ESXi objects and resources that should be inventoried by the Virtual Host Manager
                                must be assigned the <emphasis>read-only</emphasis> role. Mark
                                objects and resources with <emphasis>no-access</emphasis> to exclude
                                them from the inventory.</para></entry>
                    </row>

                </tbody>
            </tgroup>
        </informaltable>
    </sect1>

    <sect1>
        <title>Adding New Users to vSphere ESXi with vSphere Client</title>
        <para/>
    </sect1>

    <sect1>
        <title>Adding New Local Users to vCenter Via Command Line</title>
        <para/>
        <important>
            <title>Adding New Users Via VSphere Web Client</title>
            <para>It is not possible to add a new user to a vCenter Server using the vSphere Web
                Client. They must be added via Single Sign-On with the vSphere Client. You can
                however create a local user from the command line using SSH. </para>
        </important>
    </sect1>
    <sect1>
        <title>Assigning Permissions and Roles in vSphere/vCenter Server and ESXi</title>
        <para>The following section will guide you through assigning user permissions and roles in
            vCenter/ESXi.</para>
        <para>A user is someone who has been authorized access to an ESXi host. The Virtual Host
            Manager (located on the SUSE Manager server) will inventory ESXi data defined by
            assigned roles and permissions on a user account. </para>
        <para>For example: The user John has been assigned the <emphasis>read-only</emphasis> access
            role to all servers and datacenters in his company with one exception. Johns account has
            been assigned the <emphasis>no-access</emphasis> role on the company's
                <emphasis>Financial Database server </emphasis>.  If you were to use Johns user
            account when adding the ESXi host, SUSE Manager would not inventory the<emphasis>
                Financial Database server</emphasis>.</para>
        <para>Keep user access roles in mind when adding ESXi hosts to SUSE manager. It is important
            to understand that SUSE Manager will not inventory any objects or resources assigned
            with the no-access role on any users account.</para>
        <tip>
            <title>User and Host Roles/Permissions</title>
            <para>When planning to add new ESXi hosts to SUSE Manager, ask yourself the following
                question:</para>
            <para><emphasis>Have the users  associated with their hosts been provided with the
                    required roles and permissions for objects and resources that should be
                    inventoried by SUSE Manager?</emphasis></para>
        </tip>

        <procedure>
            <title>Creating a new User in ESXi</title>
            <step>
                <para/>
            </step>
        </procedure>
    </sect1>

    <sect1>
        <title>Add a vCenter Server/vSphere ESXi Host to SUSE Manager</title>
        <para>The following procedure will guide you through adding a VSphere ESXi host to
            &susemgr;.</para>
        <procedure>
            <step>
                <para>From the &susemgr; &webui; select <guimenu>Systems</guimenu> and then
                        <guimenu>Virtual Host Managers</guimenu> from the left navigation bar.
                </para>
            </step>
            <step>
                <para>From the upper right corner of the <guimenu>Virtual Host Managers</guimenu>
                    page select <guimenu>Add VMware-based Virtual Host Manager</guimenu>.</para>
            </step>
            <step>
                <para>From the <guimenu>Add a VMware-based Virtual Host Manager</guimenu> page fill
                    in the fields with your ESXi host data and select <guimenu>Add Virtual Host
                        Manager</guimenu>. </para>
                <informalfigure>
                    <mediaobject>
                        <imageobject role="fo">
                            <imagedata fileref="VMware-host-manager.png" width="444"/>
                        </imageobject>
                        <imageobject role="html">
                            <imagedata fileref="VMware-host-manager.png" width="80%"/>
                        </imageobject>
                    </mediaobject>
                </informalfigure>
            </step>
            <step>
                <para>To view your new ESXi host and its clients select <menuchoice>
                        <guimenu>Systems</guimenu>
                        <guimenu>Virtual Systems</guimenu>
                    </menuchoice>.</para>
            </step>
        </procedure>
    </sect1>
    <sect1>
        <title/>
    </sect1>
</chapter>
